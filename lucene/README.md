# CS 172 Project Information Retrieval project 2

## Description

This is a project that uses Twitter data crawled with
the [Twitter API](https://developer.twitter.com/en/docs/twitter-api) to
create indexes using `Apache Lucene` libraries.

## Index Structure

The index saved documents with fields for the tweet id, username, tweet text,
urls, title, and the date and time of the tweet. `IndexTweets.java` crawls the
Raw Data in the form of JSON files and stores them in a single index file (.cfs
file) to be used by `SearchTweets.java` for searching.

## Ranking Algorithm

For this project, the default `Lucene` ranking algorithm was used. This
algorithm works by making field specific searches for each indexed tweet before
ranking them by relevance to the query. Score boosting was also implemented to
influence the results. The scores were customized to give higher weights to text
based fields. For example, boost was adjusted to be the highest for the text
field, while title, username, urls, created_at, and id respectively followed.
Using this, the search results were ranked to give more relevance to specific
fields over others.

## Architecture

### Raw Data

The raw tweet data is stored in multiple JSON files ranging from 10-14 megabytes
in size, using the naming scheme tweet_XXX_visited.json, where XXX is a number
starting at 200 and increasing.

### Index File

The index file is built by `IndexTweets.java` by parsing the raw data and adding
each individual tweet as a document, with fields for tweet id, text, username,
urls, title of the website, the time/date it was created at, and the language
the tweet was written in.

### `IndexTweets.java`

Parses JSON files, adding each tweet individually as a document to the index.
IndexTweets uses the `json.simple` library to parse the raw tweet data, and then
creates an index using the “DOCS_AND_FREQS_AND_POSITIONS_AND_OFFSETS” index
option to keep track of the frequencies of relevant parts of the query in order
to give an accurate score for each document.

### `SearchTweets.java`

Takes the given query and searches the index for tweets that are relevant to the
query. The score of each result is weighted based on the feature, with ‘text’
having a 2x weight, ‘title’ having 1.5x weight, ‘username’ having 1.0x weight,
and ‘urls’, ‘created_at’, and ‘id’ having 0.5x weight. `SearchTweets`
uses `Lucene’s` `MultiFieldQueryParser` to parse the index for the given
features and their weights.

### Controller Classes

This project was made using `Spring Boot`, a Java based framework, used to
create a micro Service. `ViewController` acts as a web controller and maps
functions to specified directories. It is also responsible for passing and
retrieving query entered by the user. The `TweetController` works similarly by
retrieving tweets and their respective scores from the `SearchTweets`
class. `Spring Boot` specific annotations such as `@Autowired`, `@GetMapping`,
and
`@RequestMapping` were used to declare dependencies and map them to the API.

### Frontend

The frontend is styled using `html`,  `css` and `Bootstrap` framework. The tweet
results are
generated by an API call to the local machine project is built on, to access the
searched tweets. The query entered on the search bar is stored locally in a text
file so that the `SearchTweets.java` is able to access the query. Based on that
query, the top 10 highest ranking results are then displayed on to the screen
with a format of username, date, language, text and score of the tweets.

### Backend

The backend is designed utilizing the `Spring Boot` framework. The two
classes, `Queryy` and `Tweet`, are used to access the query entered by the user
and the tweet information displayed. The `IndexTweets` and `SearchTweets`
classes take the query and find the 10 highest ranking results.

## Dependencies

* [Apache Maven](https://maven.apache.org/)
* [Spring Boot 2.7](https://spring.io/projects/spring-boot)
* [Lucene-9.2.0](https://lucene.apache.org)
* [javatuples-1.2](https://www.javatuples.org)
* [json-simple-1.1.1](https://code.google.com/archive/p/json-simple/)

## Deploy the system

To deploy the system use the compiler of your choice (IntelliJ IDEA used during
development) to build the project. Add all the `jar` files in `Lucene` to the
module path of the project. In addition add `javatuples-1.2.jar`
and `json-simple-1.1.1.jar` files to the module path of the project. Next run
the `IndexTweets.java` class to build indexes for the first time. When that
ends, and run `LuceneApplication.java`. This will start the localhost server at
port *8080*. On a browser of your choice go to *localhost:8080* and simply type
in your desired query and hit the ‘Submit’ button. This will display the top 10
highest ranking results to the page in descending order of score.

### Further notes

Project resource directory should contain a `data` subdirectory that
contains `index` and `json` directories as well as the `stopwords.txt` files
and `searchword.json` files. The `index` directory must contain any file for the
project to build.
The `json` subdirectory contains all the raw tweet json files.
